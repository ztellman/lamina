<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>lamina.stats documentation</title></head><body><div id="header"><h1><a href="index.html">Lamina 0.5.0-alpha4 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3>Namespaces</h3><ul><li><a href="lamina.api.html"><span>lamina.api</span></a></li><li><a href="lamina.core.html"><span>lamina.core</span></a></li><li><a href="lamina.executor.html"><span>lamina.executor</span></a></li><li class="current"><a href="lamina.stats.html"><span>lamina.stats</span></a></li><li><a href="lamina.time.html"><span>lamina.time</span></a></li><li><a href="lamina.trace.html"><span>lamina.trace</span></a></li><li><a href="lamina.viz.html"><span>lamina.viz</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="lamina.stats.html#var-moving-average"><span>moving-average</span></a></li><li><a href="lamina.stats.html#var-moving-quantiles"><span>moving-quantiles</span></a></li><li><a href="lamina.stats.html#var-outliers"><span>outliers</span></a></li><li><a href="lamina.stats.html#var-rate"><span>rate</span></a></li><li><a href="lamina.stats.html#var-sum"><span>sum</span></a></li><li><a href="lamina.stats.html#var-variance"><span>variance</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>lamina.stats documentation</h2><pre class="doc"></pre><div class="public" id="var-moving-average"><h3>moving-average</h3><div class="usage"><code>(moving-average ch)</code><code>(moving-average {:keys [period window], :or {period (t/seconds 5), window (t/minutes 5)}} ch)</code></div><pre class="doc">Returns a channel that will periodically emit the moving average over all messages emitted by
the source channel every 'period' milliseconds, defaulting to once every five seconds.  This
moving average is exponentially weighted to the last 'window' milliseconds, defaulting to the
last five minutes.</pre></div><div class="public" id="var-moving-quantiles"><h3>moving-quantiles</h3><div class="usage"><code>(moving-quantiles ch)</code><code>(moving-quantiles {:keys [period window quantiles], :or {quantiles [50 75 95 99 99.9], period (t/seconds 5), window (t/minutes 5)}} ch)</code></div><pre class="doc">Returns a channel that will periodically emit a map of quantile values every 'period'
millseconds, which represent the statistical distribution of values emitted by the source
channel over the last five minutes.

The map will be of quantile onto quantile value, so for a uniform distribution of values from
1..1000, it would emit

  {50 500, 75 750, 95 950, 99 990, 99.9 999}

By default, the above quantiles will be used, these can be specified as a sequence of quantiles
of the form [50 98 99.9 99.99].</pre></div><div class="public" id="var-outliers"><h3>outliers</h3><div class="usage"><code>(outliers facet ch)</code><code>(outliers facet {:keys [window predicate], :or {window (t/minutes 5), predicate (fn* [p1__12926#] (&lt; 3 (abs (double p1__12926#))))}} ch)</code></div><pre class="doc">Returns a channel that will emit outliers from the source channel, as measured by the standard
deviations from the mean value of (facet msg).  Outlier status is determined by
'deviation-predicate', which is given the standard deviations from the mean, and returns true
or false.  By default, it will return true for any value where the absolute value is greater
than three.

For instance, to monitor function calls that take an unusually long or short time via a
'return' probe:

  (outliers :duration (probe-channel :name:return))

To only receive outliers that are longer than the mean, define a custom :predicate

  (outliers
    :duration
    {:window (lamina.time/minutes 15)
     :predicate #(&lt; % 3)}
    (probe-channel :name:return))

:window describes the window of the moving average, which defaults to five minutes.  This can
be used to adjust the responsiveness to long-term changes to the mean.</pre></div><div class="public" id="var-rate"><h3>rate</h3><div class="usage"><code>(rate ch)</code><code>(rate {:keys [period], :or {period 1000}} ch)</code></div><pre class="doc">Returns a channel that will periodically emit the number of messages emitted by the source
channel over the last 'period' milliseconds, with a default of 1000.</pre></div><div class="public" id="var-sum"><h3>sum</h3><div class="usage"><code>(sum ch)</code><code>(sum {:keys [period], :or {period 1000}} ch)</code></div><pre class="doc">Returns a channel that will periodically emit the sum of all messages emitted by the source
channel over the last 'period' milliseconds, with a default of 1000.

It is assumed that all numbers emitted by the source channel are integral values.</pre></div><div class="public" id="var-variance"><h3>variance</h3><div class="usage"><code>(variance ch)</code><code>(variance {:keys [period], :or {period (t/seconds 5)}} ch)</code></div><pre class="doc">Returns a channel that will periodically emit the variance of all values emitted by the source
channel every 'period' milliseconds.</pre></div></div></body></html>